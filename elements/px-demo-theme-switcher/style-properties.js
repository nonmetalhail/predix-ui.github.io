this.Px=this.Px||{};this.Px.StyleProperties=function(){"use strict";var StyleNode=function StyleNode(){babelHelpers.classCallCheck(this,StyleNode);this.start=0;this.end=0;this.previous=null;this.parent=null;this.rules=null;this.parsedCssText="";this.cssText="";this.atRule=!1;this.type=0;this.keyframesName="";this.selector="";this.parsedSelector=""};function parse(text){text=clean(text);return parseCss(lex(text),text)}function clean(cssText){return cssText.replace(RX.comments,"").replace(RX.port,"")}function lex(text){var root=new StyleNode;root.start=0;root.end=text.length;for(var n=root,i=0,l=text.length;i<l;i++){if(text[i]===OPEN_BRACE){if(!n.rules){n.rules=[]}var p=n,previous=p.rules[p.rules.length-1]||null;n=new StyleNode;n.start=i+1;n.parent=p;n.previous=previous;p.rules.push(n)}else if(text[i]===CLOSE_BRACE){n.end=i+1;n=n.parent||root}}return root}function parseCss(node,text){var t=text.substring(node.start,node.end-1);node.parsedCssText=node.cssText=t.trim();if(node.parent){var ss=node.previous?node.previous.end:node.parent.start;t=text.substring(ss,node.start-1);t=_expandUnicodeEscapes(t);t=t.replace(RX.multipleSpaces," ");t=t.substring(t.lastIndexOf(";")+1);var s=node.parsedSelector=node.selector=t.trim();node.atRule=0===s.indexOf(AT_START);if(node.atRule){if(0===s.indexOf(MEDIA_START)){node.type=types.MEDIA_RULE}else if(s.match(RX.keyframesRule)){node.type=types.KEYFRAMES_RULE;node.keyframesName=node.selector.split(RX.multipleSpaces).pop()}}else{if(0===s.indexOf(VAR_START)){node.type=types.MIXIN_RULE}else{node.type=types.STYLE_RULE}}}var r$=node.rules;if(r$){for(var i=0,l=r$.length,r;i<l&&(r=r$[i]);i++){parseCss(r,text)}}return node}function _expandUnicodeEscapes(s){return s.replace(/\\([0-9a-f]{1,6})\s/gi,function(){var code=arguments[1],repeat=6-code.length;while(repeat--){code="0"+code}return"\\"+code})}function stringify(node,preserveProperties){var text=2<arguments.length&&arguments[2]!==void 0?arguments[2]:"",cssText="";if(node.cssText||node.rules){var r$=node.rules;if(r$&&!_hasMixinRules(r$)){for(var i=0,l=r$.length,r;i<l&&(r=r$[i]);i++){cssText=stringify(r,preserveProperties,cssText)}}else{cssText=preserveProperties?node.cssText:removeCustomProps(node.cssText);cssText=cssText.trim();if(cssText){cssText="  "+cssText+"\n"}}}if(cssText){if(node.selector){text+=node.selector+" "+OPEN_BRACE+"\n"}text+=cssText;if(node.selector){text+=CLOSE_BRACE+"\n\n"}}return text}function _hasMixinRules(rules){var r=rules[0];return!!r&&!!r.selector&&0===r.selector.indexOf(VAR_START)}function removeCustomProps(cssText){cssText=removeCustomPropAssignment(cssText);return removeCustomPropApply(cssText)}function removeCustomPropAssignment(cssText){return cssText.replace(RX.customProp,"").replace(RX.mixinProp,"")}function removeCustomPropApply(cssText){return cssText.replace(RX.mixinApply,"").replace(RX.varApply,"")}var types={STYLE_RULE:1,KEYFRAMES_RULE:7,MEDIA_RULE:4,MIXIN_RULE:1e3},OPEN_BRACE="{",CLOSE_BRACE="}",RX={comments:/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,port:/@import[^;]*;/gim,customProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?(?:[;\n]|$)/gim,mixinProp:/(?:^[^;\-\s}]+)?--[^;{}]*?:[^{};]*?{[^}]*?}(?:[;\n]|$)?/gim,mixinApply:/@apply\s*\(?[^);]*\)?\s*(?:[;\n]|$)?/gim,varApply:/[^;:]*?:[^;]*?var\([^;]*\)(?:[;\n]|$)?/gim,keyframesRule:/^@[^\s]*keyframes/,multipleSpaces:/\s+/g},VAR_START="--",MEDIA_START="@media",AT_START="@",nativeShadow=!(window.ShadyDOM&&window.ShadyDOM.inUse),nativeCssVariables_;function calcCssVariables(settings){if(settings&&settings.shimcssproperties){nativeCssVariables_=!1}else{nativeCssVariables_=nativeShadow||!!(!navigator.userAgent.match(/AppleWebKit\/601|Edge\/15/)&&window.CSS&&CSS.supports&&CSS.supports("box-shadow","0 0 0 var(--foo)"))}}if(window.ShadyCSS&&window.ShadyCSS.nativeCss!==void 0){nativeCssVariables_=window.ShadyCSS.nativeCss}else if(window.ShadyCSS){calcCssVariables(window.ShadyCSS);window.ShadyCSS=void 0}else{calcCssVariables(window.WebComponents&&window.WebComponents.flags)}var nativeCssVariables=nativeCssVariables_,VAR_ASSIGN=/(?:^|[;\s{]\s*)(--[\w-]*?)\s*:\s*(?:((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};{])+)|\{([^}]*)\}(?:(?=[;\s}])|$))/gi,MIXIN_MATCH=/(?:^|\W+)@apply\s*\(?([^);\n]*)\)?/gi,VAR_CONSUMED=/(--[\w-]+)\s*([:,;)]|$)/gi,ANIMATION_MATCH=/(animation\s*:)|(animation-name\s*:)/,MEDIA_MATCH=/@media\s(.*)/,BRACKETED=/\{[^}]*\}/g;function toCssText(rules,callback){if(!rules){return""}if("string"===typeof rules){rules=parse(rules)}if(callback){forEachRule(rules,callback)}return stringify(rules,nativeCssVariables)}function rulesForStyle(style){if(!style.__cssRules&&style.textContent){style.__cssRules=parse(style.textContent)}return style.__cssRules||null}function isKeyframesSelector(rule){return!!rule.parent&&rule.parent.type===types.KEYFRAMES_RULE}function forEachRule(node,styleRuleCallback,keyframesRuleCallback,onlyActiveRules){if(!node){return}var skipRules=!1,type=node.type;if(onlyActiveRules){if(type===types.MEDIA_RULE){var matchMedia=node.selector.match(MEDIA_MATCH);if(matchMedia){if(!window.matchMedia(matchMedia[1]).matches){skipRules=!0}}}}if(type===types.STYLE_RULE){styleRuleCallback(node)}else if(keyframesRuleCallback&&type===types.KEYFRAMES_RULE){keyframesRuleCallback(node)}else if(type===types.MIXIN_RULE){skipRules=!0}var r$=node.rules;if(r$&&!skipRules){for(var i=0,l=r$.length,r;i<l&&(r=r$[i]);i++){forEachRule(r,styleRuleCallback,keyframesRuleCallback,onlyActiveRules)}}}function applyCss(cssText,moniker,target,contextNode){var style=createScopeStyle(cssText,moniker);applyStyle(style,target,contextNode);return style}function createScopeStyle(cssText,moniker){var style=document.createElement("style");if(moniker){style.setAttribute("scope",moniker)}style.textContent=cssText;return style}var lastHeadApplyNode=null;function applyStyle(style,target,contextNode){target=target||document.head;var after=contextNode&&contextNode.nextSibling||target.firstChild;target.insertBefore(style,after);if(!lastHeadApplyNode){lastHeadApplyNode=style}else{var position=style.compareDocumentPosition(lastHeadApplyNode);if(position===Node.DOCUMENT_POSITION_PRECEDING){lastHeadApplyNode=style}}}function findMatchingParen(text,start){for(var level=0,i=start,l=text.length;i<l;i++){if("("===text[i]){level++}else if(")"===text[i]){if(0===--level){return i}}}return-1}function processVariableAndFallback(str,callback){var start=str.indexOf("var(");if(-1===start){return callback(str,"","","")}var end=findMatchingParen(str,start+3),inner=str.substring(start+4,end),prefix=str.substring(0,start),suffix=processVariableAndFallback(str.substring(end+1),callback),comma=inner.indexOf(",");if(-1===comma){return callback(prefix,inner.trim(),"",suffix)}var value=inner.substring(0,comma).trim(),fallback=inner.substring(comma+1).trim();return callback(prefix,value,fallback,suffix)}function setElementClassRaw(element,value){if(nativeShadow){element.setAttribute("class",value)}else{window.ShadyDOM.nativeMethods.setAttribute.call(element,"class",value)}}function getIsExtends(element){var localName=element.localName,is="",typeExtension="";if(localName){if(-1<localName.indexOf("-")){is=localName}else{typeExtension=localName;is=element.getAttribute&&element.getAttribute("is")||""}}else{is=element.is;typeExtension=element.extends}return{is:is,typeExtension:typeExtension}}var SCOPE_NAME="style-scope",StyleTransformer=function(){function StyleTransformer(){babelHelpers.classCallCheck(this,StyleTransformer)}babelHelpers.createClass(StyleTransformer,[{key:"dom",value:function dom(node,scope,shouldRemoveScope){if(node.__styleScoped){node.__styleScoped=null}else{this._transformDom(node,scope||"",shouldRemoveScope)}}},{key:"_transformDom",value:function _transformDom(node,selector,shouldRemoveScope){if(node.nodeType===Node.ELEMENT_NODE){this.element(node,selector,shouldRemoveScope)}var c$="template"===node.localName?(node.content||node._content).childNodes:node.children||node.childNodes;if(c$){for(var i=0;i<c$.length;i++){this._transformDom(c$[i],selector,shouldRemoveScope)}}}},{key:"element",value:function element(_element,scope,shouldRemoveScope){if(scope){if(_element.classList){if(shouldRemoveScope){_element.classList.remove(SCOPE_NAME);_element.classList.remove(scope)}else{_element.classList.add(SCOPE_NAME);_element.classList.add(scope)}}else if(_element.getAttribute){var c=_element.getAttribute("class");if(shouldRemoveScope){if(c){var newValue=c.replace(SCOPE_NAME,"").replace(scope,"");setElementClassRaw(_element,newValue)}}else{var _newValue=(c?c+" ":"")+SCOPE_NAME+" "+scope;setElementClassRaw(_element,_newValue)}}}}},{key:"elementStyles",value:function elementStyles(element,styleRules,callback){var cssBuildType=element.__cssBuild,cssText="";if(nativeShadow||"shady"===cssBuildType){cssText=toCssText(styleRules,callback)}else{var _getIsExtends=getIsExtends(element),is=_getIsExtends.is,typeExtension=_getIsExtends.typeExtension;cssText=this.css(styleRules,is,typeExtension,callback)+"\n\n"}return cssText.trim()}},{key:"css",value:function css(rules,scope,ext,callback){var hostScope=this._calcHostScope(scope,ext);scope=this._calcElementScope(scope);var self=this;return toCssText(rules,function(rule){if(!rule.isScoped){self.rule(rule,scope,hostScope);rule.isScoped=!0}if(callback){callback(rule,scope,hostScope)}})}},{key:"_calcElementScope",value:function _calcElementScope(scope){if(scope){return"."+scope}else{return""}}},{key:"_calcHostScope",value:function _calcHostScope(scope,ext){return ext?"[is=".concat(scope,"]"):scope}},{key:"rule",value:function rule(_rule,scope,hostScope){this._transformRule(_rule,this._transformComplexSelector,scope,hostScope)}},{key:"_transformRule",value:function _transformRule(rule,transformer,scope,hostScope){rule.selector=rule.transformedSelector=this._transformRuleCss(rule,transformer,scope,hostScope)}},{key:"_transformRuleCss",value:function _transformRuleCss(rule,transformer,scope,hostScope){var p$=rule.selector.split(COMPLEX_SELECTOR_SEP);if(!isKeyframesSelector(rule)){for(var i=0,l=p$.length,p;i<l&&(p=p$[i]);i++){p$[i]=transformer.call(this,p,scope,hostScope)}}return p$.join(COMPLEX_SELECTOR_SEP)}},{key:"_twiddleNthPlus",value:function _twiddleNthPlus(selector){return selector.replace(NTH,function(m,type,inside){if(-1<inside.indexOf("+")){inside=inside.replace(/\+/g,"___")}else if(-1<inside.indexOf("___")){inside=inside.replace(/___/g,"+")}return":".concat(type,"(").concat(inside,")")})}},{key:"_transformComplexSelector",value:function _transformComplexSelector(selector,scope,hostScope){var _this=this,stop=!1;selector=selector.trim();var isNth=NTH.test(selector);if(isNth){selector=selector.replace(NTH,function(m,type,inner){return":".concat(type,"(").concat(inner.replace(/\s/g,""),")")});selector=this._twiddleNthPlus(selector)}selector=selector.replace(SLOTTED_START,"".concat(HOST," $1"));selector=selector.replace(SIMPLE_SELECTOR_SEP,function(m,c,s){if(!stop){var info=_this._transformCompoundSelector(s,c,scope,hostScope);stop=stop||info.stop;c=info.combinator;s=info.value}return c+s});if(isNth){selector=this._twiddleNthPlus(selector)}return selector}},{key:"_transformCompoundSelector",value:function _transformCompoundSelector(selector,combinator,scope,hostScope){var slottedIndex=selector.indexOf(SLOTTED);if(0<=selector.indexOf(HOST)){selector=this._transformHostSelector(selector,hostScope)}else if(0!==slottedIndex){selector=scope?this._transformSimpleSelector(selector,scope):selector}var slotted=!1;if(0<=slottedIndex){combinator="";slotted=!0}var stop;if(slotted){stop=!0;if(slotted){selector=selector.replace(SLOTTED_PAREN,function(m,paren){return" > ".concat(paren)})}}selector=selector.replace(DIR_PAREN,function(m,before,dir){return"[dir=\"".concat(dir,"\"] ").concat(before,", ").concat(before,"[dir=\"").concat(dir,"\"]")});return{value:selector,combinator:combinator,stop:stop}}},{key:"_transformSimpleSelector",value:function _transformSimpleSelector(selector,scope){var p$=selector.split(PSEUDO_PREFIX);p$[0]+=scope;return p$.join(PSEUDO_PREFIX)}},{key:"_transformHostSelector",value:function _transformHostSelector(selector,hostScope){var m=selector.match(HOST_PAREN),paren=m&&m[2].trim()||"";if(paren){if(!paren[0].match(SIMPLE_SELECTOR_PREFIX)){var typeSelector=paren.split(SIMPLE_SELECTOR_PREFIX)[0];if(typeSelector===hostScope){return paren}else{return"should_not_match"}}else{return selector.replace(HOST_PAREN,function(m,host,paren){return hostScope+paren})}}else{return selector.replace(HOST,hostScope)}}},{key:"documentRule",value:function documentRule(rule){rule.selector=rule.parsedSelector;this.normalizeRootSelector(rule);this._transformRule(rule,this._transformDocumentSelector)}},{key:"normalizeRootSelector",value:function normalizeRootSelector(rule){if(rule.selector===":root"){rule.selector="html"}}},{key:"_transformDocumentSelector",value:function _transformDocumentSelector(selector){return selector.match(SLOTTED)?this._transformComplexSelector(selector,SCOPE_DOC_SELECTOR):this._transformSimpleSelector(selector.trim(),SCOPE_DOC_SELECTOR)}},{key:"SCOPE_NAME",get:function get(){return SCOPE_NAME}}]);return StyleTransformer}(),NTH=/:(nth[-\w]+)\(([^)]+)\)/,SCOPE_DOC_SELECTOR=":not(.".concat(SCOPE_NAME,")"),COMPLEX_SELECTOR_SEP=",",SIMPLE_SELECTOR_SEP=/(^|[\s>+~]+)((?:\[.+?\]|[^\s>+~=[])+)/g,SIMPLE_SELECTOR_PREFIX=/[[.:#*]/,HOST=":host",SLOTTED="::slotted",SLOTTED_START=new RegExp("^(".concat(SLOTTED,")")),HOST_PAREN=/(:host)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,SLOTTED_PAREN=/(?:::slotted)(?:\(((?:\([^)(]*\)|[^)(]*)+?)\))/,DIR_PAREN=/(.*):dir\((?:(ltr|rtl))\)/,PSEUDO_PREFIX=":",StyleTransformer$1=new StyleTransformer,infoKey="__styleInfo",StyleInfo=function(){babelHelpers.createClass(StyleInfo,null,[{key:"get",value:function get(node){if(node){return node[infoKey]}else{return null}}},{key:"set",value:function set(node,styleInfo){node[infoKey]=styleInfo;return styleInfo}}]);function StyleInfo(ast,placeholder,ownStylePropertyNames,elementName,typeExtension,cssBuild){babelHelpers.classCallCheck(this,StyleInfo);this.styleRules=ast||null;this.placeholder=placeholder||null;this.ownStylePropertyNames=ownStylePropertyNames||[];this.overrideStyleProperties=null;this.elementName=elementName||"";this.cssBuild=cssBuild||"";this.typeExtension=typeExtension||"";this.styleProperties=null;this.scopeSelector=null;this.customStyle=null}babelHelpers.createClass(StyleInfo,[{key:"_getStyleRules",value:function _getStyleRules(){return this.styleRules}}]);return StyleInfo}();StyleInfo.prototype._getStyleRules=StyleInfo.prototype._getStyleRules;var matchesSelector=function(selector){var method=this.matches||this.matchesSelector||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector;return method&&method.call(this,selector)},IS_IE=navigator.userAgent.match("Trident"),XSCOPE_NAME="x-scope",StyleProperties=function(){function StyleProperties(){babelHelpers.classCallCheck(this,StyleProperties)}babelHelpers.createClass(StyleProperties,[{key:"decorateStyles",value:function decorateStyles(rules){var self=this,props={},keyframes=[],ruleIndex=0;forEachRule(rules,function(rule){self.decorateRule(rule);rule.index=ruleIndex++;self.collectPropertiesInCssText(rule.propertyInfo.cssText,props)},function(rule){keyframes.push(rule)});rules._keyframes=keyframes;var names=[];for(var i in props){names.push(i)}return names}},{key:"decorateRule",value:function decorateRule(rule){if(rule.propertyInfo){return rule.propertyInfo}var info={},properties={},hasProperties=this.collectProperties(rule,properties);if(hasProperties){info.properties=properties;rule.rules=null}info.cssText=this.collectCssText(rule);rule.propertyInfo=info;return info}},{key:"collectProperties",value:function collectProperties(rule,properties){var info=rule.propertyInfo;if(info){if(info.properties){Object.assign(properties,info.properties);return!0}}else{var m,cssText=rule.parsedCssText,value,any;while(m=VAR_ASSIGN.exec(cssText)){value=(m[2]||m[3]).trim();if("inherit"!==value||"unset"!==value){properties[m[1].trim()]=value}any=!0}return any}}},{key:"collectCssText",value:function collectCssText(rule){return this.collectConsumingCssText(rule.parsedCssText)}},{key:"collectConsumingCssText",value:function collectConsumingCssText(cssText){return cssText.replace(BRACKETED,"").replace(VAR_ASSIGN,"")}},{key:"collectPropertiesInCssText",value:function collectPropertiesInCssText(cssText,props){var m;while(m=VAR_CONSUMED.exec(cssText)){var name=m[1];if(":"!==m[2]){props[name]=!0}}}},{key:"reify",value:function reify(props){for(var names=Object.getOwnPropertyNames(props),i=0,n;i<names.length;i++){n=names[i];props[n]=this.valueForProperty(props[n],props)}}},{key:"valueForProperty",value:function valueForProperty(property,props){if(property){if(0<=property.indexOf(";")){property=this.valueForProperties(property,props)}else{var self=this;property=processVariableAndFallback(property,function fn(prefix,value,fallback,suffix){if(!value){return prefix+suffix}var propertyValue=self.valueForProperty(props[value],props);if(!propertyValue||"initial"===propertyValue){propertyValue=self.valueForProperty(props[fallback]||fallback,props)||fallback}else if("apply-shim-inherit"===propertyValue){propertyValue="inherit"}return prefix+(propertyValue||"")+suffix})}}return property&&property.trim()||""}},{key:"valueForProperties",value:function valueForProperties(property,props){for(var parts=property.split(";"),i=0,p,m;i<parts.length;i++){if(p=parts[i]){MIXIN_MATCH.lastIndex=0;m=MIXIN_MATCH.exec(p);if(m){p=this.valueForProperty(props[m[1]],props)}else{var colon=p.indexOf(":");if(-1!==colon){var pp=p.substring(colon);pp=pp.trim();pp=this.valueForProperty(pp,props)||pp;p=p.substring(0,colon)+pp}}parts[i]=p&&p.lastIndexOf(";")===p.length-1?p.slice(0,-1):p||""}}return parts.join(";")}},{key:"applyProperties",value:function applyProperties(rule,props){var output="";if(!rule.propertyInfo){this.decorateRule(rule)}if(rule.propertyInfo.cssText){output=this.valueForProperties(rule.propertyInfo.cssText,props)}rule.cssText=output}},{key:"applyKeyframeTransforms",value:function applyKeyframeTransforms(rule,keyframeTransforms){var input=rule.cssText,output=rule.cssText;if(null==rule.hasAnimations){rule.hasAnimations=ANIMATION_MATCH.test(input)}if(rule.hasAnimations){var transform;if(null==rule.keyframeNamesToTransform){rule.keyframeNamesToTransform=[];for(var keyframe in keyframeTransforms){transform=keyframeTransforms[keyframe];output=transform(input);if(input!==output){input=output;rule.keyframeNamesToTransform.push(keyframe)}}}else{for(var i=0;i<rule.keyframeNamesToTransform.length;++i){transform=keyframeTransforms[rule.keyframeNamesToTransform[i]];input=transform(input)}output=input}}rule.cssText=output}},{key:"propertyDataFromStyles",value:function propertyDataFromStyles(rules,element){var props={},self=this,o=[];forEachRule(rules,function(rule){if(!rule.propertyInfo){self.decorateRule(rule)}var selectorToMatch=rule.transformedSelector||rule.parsedSelector;if(element&&rule.propertyInfo.properties&&selectorToMatch){if(matchesSelector.call(element,selectorToMatch)){self.collectProperties(rule,props);addToBitMask(rule.index,o)}}},null,!0);return{properties:props,key:o}}},{key:"whenHostOrRootRule",value:function whenHostOrRootRule(scope,rule,cssBuild,callback){if(!rule.propertyInfo){this.decorateRule(rule)}if(!rule.propertyInfo.properties){return}var _getIsExtends2=getIsExtends(scope),is=_getIsExtends2.is,typeExtension=_getIsExtends2.typeExtension,hostScope=is?StyleTransformer$1._calcHostScope(is,typeExtension):"html",parsedSelector=rule.parsedSelector,isRoot=":host > *"===parsedSelector||"html"===parsedSelector,isHost=0===parsedSelector.indexOf(":host")&&!isRoot;if("shady"===cssBuild){isRoot=parsedSelector===hostScope+" > *."+hostScope||-1!==parsedSelector.indexOf("html");isHost=!isRoot&&0===parsedSelector.indexOf(hostScope)}if("shadow"===cssBuild){isRoot=":host > *"===parsedSelector||"html"===parsedSelector;isHost=isHost&&!isRoot}if(!isRoot&&!isHost){return}var selectorToMatch=hostScope;if(isHost){if(!rule.transformedSelector){rule.transformedSelector=StyleTransformer$1._transformRuleCss(rule,StyleTransformer$1._transformComplexSelector,StyleTransformer$1._calcElementScope(is),hostScope)}selectorToMatch=rule.transformedSelector||hostScope}callback({selector:selectorToMatch,isHost:isHost,isRoot:isRoot})}},{key:"hostAndRootPropertiesForScope",value:function hostAndRootPropertiesForScope(scope,rules){var hostProps={},rootProps={},self=this,cssBuild=rules&&rules.__cssBuild;forEachRule(rules,function(rule){self.whenHostOrRootRule(scope,rule,cssBuild,function(info){var element=scope._element||scope;if(matchesSelector.call(element,info.selector)){if(info.isHost){self.collectProperties(rule,hostProps)}else{self.collectProperties(rule,rootProps)}}})},null,!0);return{rootProps:rootProps,hostProps:hostProps}}},{key:"transformStyles",value:function transformStyles(element,properties,scopeSelector){var self=this,_getIsExtends3=getIsExtends(element),is=_getIsExtends3.is,typeExtension=_getIsExtends3.typeExtension,hostSelector=StyleTransformer$1._calcHostScope(is,typeExtension),rxHostSelector=element.extends?"\\"+hostSelector.slice(0,-1)+"\\]":hostSelector,hostRx=new RegExp("(?:^|[^.#[:])"+rxHostSelector+"($|[.:[\\s>+~])"),rules=StyleInfo.get(element).styleRules,keyframeTransforms=this._elementKeyframeTransforms(element,rules,scopeSelector);return StyleTransformer$1.elementStyles(element,rules,function(rule){self.applyProperties(rule,properties);if(!nativeShadow&&!isKeyframesSelector(rule)&&rule.cssText){self.applyKeyframeTransforms(rule,keyframeTransforms);self._scopeSelector(rule,hostRx,hostSelector,scopeSelector)}})}},{key:"_elementKeyframeTransforms",value:function _elementKeyframeTransforms(element,rules,scopeSelector){var keyframesRules=rules._keyframes,keyframeTransforms={};if(!nativeShadow&&keyframesRules){for(var i=0,keyframesRule=keyframesRules[i];i<keyframesRules.length;keyframesRule=keyframesRules[++i]){this._scopeKeyframes(keyframesRule,scopeSelector);keyframeTransforms[keyframesRule.keyframesName]=this._keyframesRuleTransformer(keyframesRule)}}return keyframeTransforms}},{key:"_keyframesRuleTransformer",value:function _keyframesRuleTransformer(keyframesRule){return function(cssText){return cssText.replace(keyframesRule.keyframesNameRx,keyframesRule.transformedKeyframesName)}}},{key:"_scopeKeyframes",value:function _scopeKeyframes(rule,scopeId){rule.keyframesNameRx=new RegExp("\\b".concat(rule.keyframesName,"(?!\\B|-)"),"g");rule.transformedKeyframesName=rule.keyframesName+"-"+scopeId;rule.transformedSelector=rule.transformedSelector||rule.selector;rule.selector=rule.transformedSelector.replace(rule.keyframesName,rule.transformedKeyframesName)}},{key:"_scopeSelector",value:function _scopeSelector(rule,hostRx,hostSelector,scopeId){rule.transformedSelector=rule.transformedSelector||rule.selector;for(var selector=rule.transformedSelector,scope="."+scopeId,parts=selector.split(","),i=0,l=parts.length,p;i<l&&(p=parts[i]);i++){parts[i]=p.match(hostRx)?p.replace(hostSelector,scope):scope+" "+p}rule.selector=parts.join(",")}},{key:"applyElementScopeSelector",value:function applyElementScopeSelector(element,selector,old){var c=element.getAttribute("class")||"",v=c;if(old){v=c.replace(new RegExp("\\s*"+XSCOPE_NAME+"\\s*"+old+"\\s*","g")," ")}v+=(v?" ":"")+XSCOPE_NAME+" "+selector;if(c!==v){setElementClassRaw(element,v)}}},{key:"applyElementStyle",value:function applyElementStyle(element,properties,selector,style){var cssText=style?style.textContent||"":this.transformStyles(element,properties,selector),styleInfo=StyleInfo.get(element),s=styleInfo.customStyle;if(s&&!nativeShadow&&s!==style){s._useCount--;if(0>=s._useCount&&s.parentNode){s.parentNode.removeChild(s)}}if(nativeShadow){if(styleInfo.customStyle){styleInfo.customStyle.textContent=cssText;style=styleInfo.customStyle}else if(cssText){style=applyCss(cssText,selector,element.shadowRoot,styleInfo.placeholder)}}else{if(!style){if(cssText){style=applyCss(cssText,selector,null,styleInfo.placeholder)}}else if(!style.parentNode){if(IS_IE&&-1<cssText.indexOf("@media")){style.textContent=cssText}applyStyle(style,null,styleInfo.placeholder)}}if(style){style._useCount=style._useCount||0;if(styleInfo.customStyle!=style){style._useCount++}styleInfo.customStyle=style}return style}},{key:"applyCustomStyle",value:function applyCustomStyle(style,properties){var rules=rulesForStyle(style),self=this;style.textContent=toCssText(rules,function(rule){var css=rule.cssText=rule.parsedCssText;if(rule.propertyInfo&&rule.propertyInfo.cssText){css=removeCustomPropAssignment(css);rule.cssText=self.valueForProperties(css,properties)}})}},{key:"XSCOPE_NAME",get:function get(){return XSCOPE_NAME}}]);return StyleProperties}();function addToBitMask(n,bits){var o=parseInt(n/32,10);bits[o]=(bits[o]||0)|1<<n%32}var styleProperties=new StyleProperties;return styleProperties}();